# Linux计划任务服务程序

计划任务服务程序主要用于在指定的时间段自动启用或停止某些服务或命令，而无需人为的介入，从而实现自动化运维。

计划任务分为两类：

- 单次计划任务，一般用于满足临时的工作需求。例如：指定今天晚上11点30分开启网站服务。
- 多次长期性计划任务，一般用于周期性地、有规律性的执行某些具体的任务。例如：每周一的凌晨3点将/home/wwwroot目录打包备份为backup.tar.gz。



## 单次计划任务

可以使用at命令实现单次计划任务，只需要指定具体时间即可。默认采用的是交互式的形式来设置计划任务。

### 创建单次计划任务

示例一，在20:05分，创建一个文件：

```shell
[root@localhost mail]# at 04:06
at> touch wyang.txt
at> 此处请同时按下Ctrl+d来结束编写计划任务
job 3 at Fri Nov 15 04:06:00 2019
```

### 查看单次计划任务

使用at -l命令来查看已设置好但是还未执行的单次计划任务：

```shell
[root@localhost mail]# at -l
1	Sat Nov 16 04:02:00 2019 a root
```

上述显示的结果的开头为当前任务的序号。

### 删除单次计划任务

使用atrm命令删除已设置的计划任务，需要指定任务序号。

例如，删除序号为1的单次计划任务：

```shell
[root@localhost mail]# atrm 1
[root@localhost mail]# at -l
无任何结果
```

### 示例

使用管道符，让at命令接收前面echo命令的输出信息，以达到通过非交互式的方式创建计划一次性任务的目的。

```shell
[root@localhost mail]# echo "echo 'wwwwwww'" | at 04:16
job 4 at Fri Nov 15 04:16:00 2019
```



## 多次长期性计划任务

使用crond命令创建周期性地、有规律地多次长期性计划任务。

### 创建、编辑长期性计划任务

使用crontab -e命令来创建或编辑计划任务。格式如下：

```
crontab -e
```

一旦执行了上述命令之后，将会进入到编写计划任务格式语句的交互界面。

#### 设置任务的参数格式与说明

设置任务的参数格式如下：

```
分钟 小时 日期 月份 星期 命令
50  3    2   1   *    run_command
```

参数字段说明如下表所示：

| 参数 | 说明                                     |
| ---- | ---------------------------------------- |
| 分钟 | 取值为0～59的整数                        |
| 小时 | 取值为0～23的任意整数                    |
| 日期 | 取值为1～31的任意整数                    |
| 月份 | 取值为1～12的任意整数                    |
| 星期 | 取值为0～7的任意整数，其中0与7均为星期日 |
| 命令 | 要执行的命令或程序脚本                   |

需要注意的是：

- 如果有些参数没有设置，则需要使用星号（*****）占位。
- 





### 查看长期性计划任务

使用crontab -l命令查看当前计划任务。

### 删除长期性计划任务

使用crontab -r命令删除某条计划任务。

### 编辑他人的计划任务

如果是以管理员的身份登录的系统，还可以在crontab命令中加上-u参数来编辑他人的计划任务。